<script>
  const codes = {
    TEST001: {
      Zing: {
        pin: 'PZ2J8R68R',
        serial: '8D0116173988'
      },
      Garena: {
        pin: 'PZ2J8R68R',
        serial: '8D0116173988'
      }
    }
  };

  const usedCodes = new Set();

  function redeem() {
    const type = document.getElementById("type").value;
    const code = document.getElementById("code").value.trim().toUpperCase();
    const res = document.getElementById("result");
    const err = document.getElementById("error");

    res.style.display = "none";
    err.innerText = "";

    if (!codes[code]) {
      err.innerText = "❌ Mã không tồn tại.";
      return;
    }

    if (usedCodes.has(code)) {
      err.innerText = "⚠️ Mã này đã được sử dụng.";
      return;
    }

    const cardData = codes[code][type];
    if (!cardData) {
      err.innerText = `❌ Mã này không hỗ trợ thẻ ${type}`;
      return;
    }

    document.getElementById("pin").value = cardData.pin;
    document.getElementById("serial").value = cardData.serial;
    document.getElementById("cardType").innerText = type;
    res.style.display = "block";

    usedCodes.add(code);
    delete codes[code];
  }
</script>
